/* empty css                     */import{d as k,r as d,c as g,a as i,b as o,m as z,e as N,w as s,E as I,f as L,g as P,h as _,i as W,j as B,k as R,F,l as H,n as O,o as $,u as G,p as J,q as f,s as q,t as M,_ as A}from"./index-Bj8NFsnu.js";const D={class:"cropper"},K={style:{display:"flex","align-items":"center","justify-content":"center"}},Q={class:"upload-section"},X=k({__name:"Cropper",setup(Y){const e=d({img:"",outputSize:90,autoCropWidth:10,autoCropHeight:10,enlarge:1,outputType:"",info:!0,canScale:!0,autoCrop:!0,full:!1,infoTrue:!1,mode:"contain",original:!1,maxImgSize:"10000"}),v=["jpeg","png","webp"],p=d(),c=d(),m=d(""),h=n=>new Promise((l,a)=>{const t=new Image;t.onload=()=>{l({url:URL.createObjectURL(n),height:t.height,width:t.width,outputType:n.type.split("/")[1],fileName:n.name})},t.onerror=()=>a(new Error("图片加载失败")),t.src=URL.createObjectURL(n)}),b=async n=>{const l=n.raw;if(!l)return;if(!["image/jpeg","image/png","image/webp"].includes(l.type)){M.error("只支持 JPG/PNG/WEBP 格式的图片");return}e.value.img="",e.value.outputType="",m.value="";const a=await h(l);e.value.img=a.url,e.value.outputType=a.outputType,m.value=a.fileName;let t=0;p.value.offsetHeight/p.value.offsetWidth>a.height/a.width?t=p.value.offsetWidth/a.width:t=p.value.offsetHeight/a.height,t>1&&(t=1),e.value.enlarge=1/t,e.value.autoCropWidth=a.width*t,e.value.autoCropHeight=a.height*t},y=()=>{c.value.getCropBlob(n=>{const l=document.createElement("a");let a=m.value.replace(/\.(jpg|jpeg|png|webp)$/i,`.${e.value.outputType}`);l.download=`new_${a}`,l.href=URL.createObjectURL(n),l.click()})},w=n=>{console.log(n)};return(n,l)=>{const a=N("vueCropper"),t=W,r=P,C=B,V=q,E=R,x=O,U=I,T=$,S=L;return f(),g("div",D,[i("div",{class:"crop",ref_key:"crop",ref:p},[o(a,z({ref_key:"cropper",ref:c},e.value,{outputSize:e.value.outputSize/100,onRealTime:w}),null,16,["outputSize"])],512),o(U,{inline:""},{default:s(()=>[o(r,{label:"宽高"},{default:s(()=>[i("div",K,[o(t,{style:{width:"100px"},disabled:!e.value.img,"controls-position":"right",modelValue:e.value.autoCropWidth,"onUpdate:modelValue":l[0]||(l[0]=u=>e.value.autoCropWidth=u)},null,8,["disabled","modelValue"]),l[5]||(l[5]=_(" × ")),o(t,{style:{width:"100px"},disabled:!e.value.img,"controls-position":"right",modelValue:e.value.autoCropHeight,"onUpdate:modelValue":l[1]||(l[1]=u=>e.value.autoCropHeight=u)},null,8,["disabled","modelValue"])])]),_:1}),o(r,{label:"输出比例倍数"},{default:s(()=>[o(t,{style:{width:"100px"},disabled:!e.value.img,"controls-position":"right",modelValue:e.value.enlarge,"onUpdate:modelValue":l[2]||(l[2]=u=>e.value.enlarge=u)},null,8,["disabled","modelValue"])]),_:1}),o(r,{label:`压缩质量 (${e.value.outputSize}%)`},{default:s(()=>[o(C,{style:{width:"160px"},modelValue:e.value.outputSize,"onUpdate:modelValue":l[3]||(l[3]=u=>e.value.outputSize=u),min:1,max:100,disabled:!e.value.img},null,8,["modelValue","disabled"])]),_:1},8,["label"]),o(r,{label:"输出格式"},{default:s(()=>[o(E,{style:{width:"140px"},modelValue:e.value.outputType,"onUpdate:modelValue":l[4]||(l[4]=u=>e.value.outputType=u),disabled:!e.value.img},{default:s(()=>[(f(),g(F,null,H(v,(u,j)=>o(V,{key:j,label:`image/${u}`,value:u},null,8,["label","value"])),64))]),_:1},8,["modelValue","disabled"])]),_:1}),o(r,{label:""},{default:s(()=>[o(x,{type:"primary",onClick:y},{default:s(()=>l[6]||(l[6]=[_("保存")])),_:1,__:[6]})]),_:1})]),_:1}),i("div",Q,[o(S,{class:"upload-drop-zone",drag:"","auto-upload":!1,accept:"image/*","show-file-list":!1,onChange:b},{default:s(()=>[o(T,{class:"upload-icon"},{default:s(()=>[o(G(J))]),_:1}),l[7]||(l[7]=i("div",{class:"upload-text"},[i("h3",null,"将多张图片拖到此处，或点击上传"),i("p",null,"支持 PNG/JPG/WEBP 格式")],-1))]),_:1,__:[7]})])])}}}),le=A(X,[["__scopeId","data-v-f2996194"]]);export{le as default};
